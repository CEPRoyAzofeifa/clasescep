<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Práctica de Excel - Ofimática CEP</title>
    <style>
        /* [Todos los estilos anteriores se mantienen igual] */
        .pdf-button {
            background: linear-gradient(to bottom, #e74c3c, #c0392b);
            margin: 15px 0;
        }
        .pdf-button:hover {
            background: linear-gradient(to bottom, #c0392b, #a5281b);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <!-- [Todo el contenido HTML anterior se mantiene igual hasta la sección de instrucciones] -->
    
    <div class="instrucciones">
        <h2>Instrucciones:</h2>
        <p>1. Utilice los siguientes datos separados para practicar en Excel.</p>
        <p>2. Copie los datos o descargue el archivo CSV para importar a Excel.</p>
        <p>3. Combine los datos según sea necesario para realizar los ejercicios.</p>
        <button onclick="generarPDF()" class="pdf-button">
            <i class="fas fa-file-pdf"></i> Descargar Guía Paso a Paso (Para Principiantes)
        </button>
    </div>

    <!-- [Resto del contenido HTML se mantiene igual] -->

    <script>
        // [Funciones copiarTexto() y descargarCSV() se mantienen igual]

        function generarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configuración inicial
            doc.setFont("helvetica", "normal");
            doc.setFontSize(16);
            doc.setTextColor(40, 53, 147);
            doc.text('Guía Paso a Paso para Principiantes', 105, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('Práctica de Excel - Ofimática CEP', 105, 30, { align: 'center' });
            
            // Agregar contenido
            let y = 45;
            
            // 1. Combinar nombres con datos
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('1. Combinar nombres con datos numéricos', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Si los datos están separados:', 20, y);
            y += 7;
            doc.text('  a) Copia los nombres de la columna A', 25, y);
            y += 7;
            doc.text('  b) Pega en una nueva hoja de Excel (columna A)', 25, y);
            y += 7;
            doc.text('  c) Copia los datos numéricos (3 columnas)', 25, y);
            y += 7;
            doc.text('  d) Pega junto a los nombres (columnas B, C, D)', 25, y);
            y += 15;
            
            // 2. Calcular promedio
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('2. Calcular promedio por estudiante', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- En la columna E (junto a los datos), escribe:', 20, y);
            y += 7;
            doc.setTextColor(200, 0, 0);
            doc.text('  =PROMEDIO(B2:D2)', 25, y);
            y += 7;
            doc.setTextColor(0, 0, 0);
            doc.text('- Haz clic en la esquina inferior derecha de la celda y arrastra hacia abajo', 20, y);
            y += 15;
            
            // 3. Máximo y mínimo
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('3. Encontrar máximo y mínimo', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Debajo de los datos (ej. celda B17), escribe:', 20, y);
            y += 7;
            doc.setTextColor(200, 0, 0);
            doc.text('  =MÁX(B2:B16)  → Para el valor más alto', 25, y);
            y += 7;
            doc.text('  =MÍN(B2:B16)  → Para el valor más bajo', 25, y);
            y += 7;
            doc.setTextColor(0, 0, 0);
            doc.text('- Repite para las columnas C y D', 20, y);
            y += 15;
            
            // 4. Columna Total
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('4. Crear columna "Total"', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- En la columna F, escribe:', 20, y);
            y += 7;
            doc.setTextColor(200, 0, 0);
            doc.text('  =SUMA(B2:D2)', 25, y);
            y += 7;
            doc.setTextColor(0, 0, 0);
            doc.text('- Arrastra la fórmula hacia abajo', 20, y);
            y += 15;
            
            // 5. Columna Estado
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('5. Columna "Estado"', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- En la columna G, escribe:', 20, y);
            y += 7;
            doc.setTextColor(200, 0, 0);
            doc.text('  =SI(F2>1500,"Excelente",SI(F2>1000,"Bueno","Regular"))', 25, y);
            y += 7;
            doc.setTextColor(0, 0, 0);
            doc.text('- Explicación:', 20, y);
            y += 7;
            doc.text('  Si Total > 1500 → "Excelente"', 25, y);
            y += 7;
            doc.text('  Si Total > 1000 → "Bueno"', 25, y);
            y += 7;
            doc.text('  Si Total ≤ 1000 → "Regular"', 25, y);
            y += 15;
            
            // 6. Desviación estándar
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('6. Desviación estándar', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Debajo de los datos (ej. celda B19), escribe:', 20, y);
            y += 7;
            doc.setTextColor(200, 0, 0);
            doc.text('  =DESVEST.M(B2:B16)', 25, y);
            y += 7;
            doc.setTextColor(0, 0, 0);
            doc.text('- Esto muestra qué tan dispersos están los datos', 20, y);
            y += 15;
            
            // 7. Gráfico de barras
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('7. Gráfico de barras (Promedios)', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Selecciona los nombres (A2:A16) y los promedios (E2:E16)', 20, y);
            y += 7;
            doc.text('- Ve a la pestaña "Insertar"', 20, y);
            y += 7;
            doc.text('- Haz clic en "Gráfico de barras"', 20, y);
            y += 7;
            doc.text('- Elige el primer estilo de gráfico', 20, y);
            y += 15;
            
            // 8. Gráfico de dispersión
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('8. Gráfico de dispersión', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Selecciona Número 1 (B2:B16) y Número 2 (C2:C16)', 20, y);
            y += 7;
            doc.text('- Ve a "Insertar" → "Gráficos" → "Dispersión"', 20, y);
            y += 7;
            doc.text('- Elige el primer gráfico de puntos (X Y)', 20, y);
            y += 15;
            
            // 9. Formato condicional
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('9. Resaltar valores > 400', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Selecciona los datos numéricos (B2:D16)', 20, y);
            y += 7;
            doc.text('- Ve a "Inicio" → "Formato condicional"', 20, y);
            y += 7;
            doc.text('- Elige "Mayor que" y escribe 400', 20, y);
            y += 7;
            doc.text('- Selecciona un color de resaltado', 20, y);
            y += 15;
            
            // 10. Ordenar datos
            doc.setFontSize(14);
            doc.setTextColor(30, 136, 229);
            doc.text('10. Ordenar por Total', 20, y);
            y += 8;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('- Selecciona TODOS los datos (A1:G16)', 20, y);
            y += 7;
            doc.text('- Ve a "Datos" → "Ordenar"', 20, y);
            y += 7;
            doc.text('- Ordena por columna "Total" → "De mayor a menor"', 20, y);
            
            // Pie de página
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('© 2023 - Ing. Roy Azofeifa - Material didáctico para Ofimática CEP', 105, 290, { align: 'center' });
            
            // Guardar PDF
            doc.save('Guia_Excel_Para_Principiantes_CEP.pdf');
            
            // Feedback visual
            const boton = document.querySelector('button[onclick="generarPDF()"]');
            const originalHTML = boton.innerHTML;
            boton.innerHTML = '<i class="fas fa-check"></i> PDF Generado!';
            
            setTimeout(() => {
                boton.innerHTML = originalHTML;
            }, 2000);
        }
    </script>
</body>
</html>
